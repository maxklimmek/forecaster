{"mappings":"MAAA,IAAOA,E,IAAKC,KAAAD,MAAA,KACV,4BADUC,EAEV,wBAFUA,EAGV,wBAHUA,EAIV,oDAJUA,EAKV,wDALUA,EAMV,gCANUA,EAOV,wCCNF,MAAMC,EAAS,gCAeR,SAASC,EAAeC,GAC7B,MAAMC,EAAUC,OAAOC,QAAQC,cAAcH,QAC7C,OAAOD,GAASK,SAAWP,GAAUE,GAASC,UAAYA,CAC5D,CCdA,MAAMK,EAAW,yBACXC,EAAW,QACXC,EAAc,WACdC,EAAY,SACZC,EAAa,UAYbC,EAAY,KACd,GAAIC,SAASC,eAAeP,GACxB,OAAOM,SAASC,eAAeP,GAEnC,MAAMQ,EAASF,SAASG,cAAc,UAMtC,OALAD,EAAOE,GAAKV,EACZQ,EAAOG,IAAMf,OAAOC,QAAQe,OAAO,cACnCJ,EAAOK,UAAUC,IAAIb,EAAUG,GAC/BI,EAAOO,MAAQ,mBACfP,EAAOQ,aAAa,aAAc,oBAC3BR,CAAA,EA0BLS,EAAY,KACd,MAAMT,EAASH,IACfG,EAAOU,MAAMC,QAhDI,MACjB,MAAMC,EAAWd,SAASe,qBAAqB,KAC/C,IAAIC,EAAY,WAChB,IAAK,IAAIC,EAAI,EAAGA,EAAIH,EAASI,OAAQD,IAAK,CACtC,MAAMJ,EAASM,SAASC,OAAOC,iBAAiBP,EAASG,IAAIJ,OAAkB,IAC/EG,EAAYH,EAASG,EAAYH,EAASG,CAC9C,CACA,OAAOA,CAAA,EAyCgBM,GAAiB,GAAGC,WAC3CvB,SAASwB,KAAKC,YAAYvB,EAAA,EAGxBwB,EAAY,KACd,MAAMxB,EAASH,IACfC,SAASC,eAAeP,IAAWiC,eAAeC,YAAY1B,EAAA,EAgBlEZ,OAAOC,QAAQsC,UAAUC,aAAY,CAACC,EAA8BC,EAAGC,KAEnE,GADAC,QAAQC,IAAI,kCAAmCJ,IAC1C5C,EAAe4C,GAEhB,YADAG,QAAQC,IAAI,uBAGhB,MAAMC,OAAEA,EAAMC,QAAEA,GAAYN,EAXX,IAACO,EAYdF,IAAWpD,EAAcuD,eAnBzBvC,SAASC,eAAeP,GACxBgC,IAEAf,KAmBAyB,IAAWpD,EAAcwD,YACzB7B,IAEAyB,IAAWpD,EAAcyD,YACzBf,IAGAU,IAAWpD,EAAc0D,0BA/DF,MAC3B,MAAMxC,EAASH,IACXG,EAAOK,UAAUoC,SAAShD,IAC1BO,EAAOK,UAAUqC,OAAOjD,GACxBO,EAAOK,UAAUC,IAAIZ,KAErBM,EAAOK,UAAUqC,OAAOhD,GACxBM,EAAOK,UAAUC,IAAIb,GACzB,EAwDIkD,GAGAT,IAAWpD,EAAc8D,4BAxDA,MAC7B,MAAM5C,EAASH,IACXG,EAAOK,UAAUoC,SAAS7C,IAC1BI,EAAOK,UAAUqC,OAAO9C,GACxBI,EAAOK,UAAUC,IAAIX,KAErBK,EAAOK,UAAUqC,OAAO/C,GACxBK,EAAOK,UAAUC,IAAIV,GACzB,EAiDIiD,GAGAX,IAAWpD,EAAcgE,iBA9BXV,EA+BDD,EA9BFtC,IACRa,MAAMqC,UAAYX,EAAS,MAgC9BF,IAAWpD,EAAckE,oBACzBjB,EAAM,e","sources":["src/message-actions.ts","src/prepare-message.ts","src/content-script.ts"],"sourcesContent":["export enum MessageAction {\r\n  TOGGLE_POPUP = \"TOGGLE_POPUP\",\r\n  SHOW_POPUP = \"SHOW_POPUP\",\r\n  HIDE_POPUP = \"HIDE_POPUP\",\r\n  TOGGLE_VERTICAL_POSITION = \"TOGGLE_VERTICAL_POSITION\",\r\n  TOGGLE_HORIZONTAL_POSITION = \"TOGGLE_HORIZONTAL_POSITION\",\r\n  SET_MAX_HEIGHT = \"SET_MAX_HEIGHT\",\r\n  CHECK_INSTALLATION = \"CHECK_INSTALLATION\"\r\n}\r\n","import { MessageAction } from \"./message-actions\";\r\nconst source = \"__sales_discount_calculator__\";\r\nexport type ExtensionMessagePayload = {\r\n  action: MessageAction;\r\n  payload?: any;\r\n  source: typeof source;\r\n  version: string;\r\n};\r\nexport default function prepareMessage(\r\n  action: MessageAction,\r\n  payload?: any\r\n): ExtensionMessagePayload {\r\n  const version = chrome.runtime.getManifest().version;\r\n  return { source, action, payload, version };\r\n}\r\n\r\nexport function isValidMessage(message: any) {\r\n  const version = chrome.runtime.getManifest().version;\r\n  return message?.source === source && message?.version === version;\r\n}\r\n","import { MessageAction } from \"./message-actions\";\r\nimport {\r\n    ExtensionMessagePayload,\r\n    isValidMessage\r\n} from \"./prepare-message\";\r\nconst iframeId = '_sale_calculator_panel';\r\nconst topClass = '__top';\r\nconst bottomClass = '__bottom';\r\nconst leftClass = '__left';\r\nconst rightClass = '__right';\r\n\r\nconst getMaxZIndex = () => {\r\n    const elements = document.getElementsByTagName('*');\r\n    let maxZIndex = 2147483647;\r\n    for (let i = 0; i < elements.length; i++) {\r\n        const zIndex = parseInt(window.getComputedStyle(elements[i]).zIndex as string, 10);\r\n        maxZIndex = zIndex > maxZIndex ? zIndex : maxZIndex;\r\n    }\r\n    return maxZIndex;\r\n}\r\n\r\nconst getIframe = () => {\r\n    if (document.getElementById(iframeId)) {\r\n        return document.getElementById(iframeId) as HTMLIFrameElement;\r\n    }\r\n    const iframe = document.createElement(\"iframe\");\r\n    iframe.id = iframeId;\r\n    iframe.src = chrome.runtime.getURL(\"index.html\");\r\n    iframe.classList.add(topClass, rightClass);\r\n    iframe.title = \"Sales Calculator\";\r\n    iframe.setAttribute('aria-label', 'Sales Calculator');\r\n    return iframe as HTMLIFrameElement;\r\n}\r\n\r\n\r\nconst toggleVerticalPosition = () => {\r\n    const iframe = getIframe();\r\n    if (iframe.classList.contains(topClass)) {\r\n        iframe.classList.remove(topClass);\r\n        iframe.classList.add(bottomClass);\r\n    } else {\r\n        iframe.classList.remove(bottomClass);\r\n        iframe.classList.add(topClass);\r\n    }\r\n};\r\n\r\nconst toggleHorizontalPosition = () => {\r\n    const iframe = getIframe();\r\n    if (iframe.classList.contains(rightClass)) {\r\n        iframe.classList.remove(rightClass);\r\n        iframe.classList.add(leftClass);\r\n    } else {\r\n        iframe.classList.remove(leftClass);\r\n        iframe.classList.add(rightClass);\r\n    }\r\n};\r\n\r\nconst showPopup = () => {\r\n    const iframe = getIframe();\r\n    iframe.style.zIndex = (getMaxZIndex() + 1).toString();\r\n    document.body.appendChild(iframe);\r\n};\r\n\r\nconst hidePopup = () => {\r\n    const iframe = getIframe();\r\n    document.getElementById(iframeId)?.parentElement?.removeChild(iframe);\r\n};\r\n\r\nconst togglePopup = () => {\r\n    if (document.getElementById(iframeId)) {\r\n        hidePopup();\r\n    } else {\r\n        showPopup();\r\n    }\r\n};\r\n\r\nconst setMaxHeight = (height: number) => {\r\n    const iframe = getIframe();\r\n    iframe.style.maxHeight = height + \"px\";\r\n};\r\n\r\nchrome.runtime.onMessage.addListener((msg: ExtensionMessagePayload, _, reply) => {\r\n    console.log(\"content script received message\", msg);\r\n    if (!isValidMessage(msg)) {\r\n        console.log(`Validation failed!!`);\r\n        return;\r\n    }\r\n    const { action, payload } = msg;\r\n    if (action === MessageAction.TOGGLE_POPUP) {\r\n        togglePopup();\r\n    }\r\n    if (action === MessageAction.SHOW_POPUP) {\r\n        showPopup();\r\n    }\r\n    if (action === MessageAction.HIDE_POPUP) {\r\n        hidePopup();\r\n    }\r\n\r\n    if (action === MessageAction.TOGGLE_VERTICAL_POSITION) {\r\n        toggleVerticalPosition();\r\n    }\r\n\r\n    if (action === MessageAction.TOGGLE_HORIZONTAL_POSITION) {\r\n        toggleHorizontalPosition();\r\n    }\r\n\r\n    if (action === MessageAction.SET_MAX_HEIGHT) {\r\n        setMaxHeight(payload);\r\n    }\r\n\r\n    if (action === MessageAction.CHECK_INSTALLATION) {\r\n        reply('installed');\r\n    }\r\n});\r\n\r\nexport { };\r\n\r\n"],"names":["$7452a5cb7a43a7c8$export$865c0eaaa43d90f8","MessageAction","$0b49b56a77d13354$var$source","$0b49b56a77d13354$export$f648e44869ab6afd","message","version","chrome","runtime","getManifest","source","$a373d99da8d74fbb$var$iframeId","$a373d99da8d74fbb$var$topClass","$a373d99da8d74fbb$var$bottomClass","$a373d99da8d74fbb$var$leftClass","$a373d99da8d74fbb$var$rightClass","$a373d99da8d74fbb$var$getIframe","document","getElementById","iframe","createElement","id","src","getURL","classList","add","title","setAttribute","$a373d99da8d74fbb$var$showPopup","style","zIndex","elements","getElementsByTagName","maxZIndex","i","length","parseInt","window","getComputedStyle","$a373d99da8d74fbb$var$getMaxZIndex","toString","body","appendChild","$a373d99da8d74fbb$var$hidePopup","parentElement","removeChild","onMessage","addListener","msg","_","reply","console","log","action","payload","height","TOGGLE_POPUP","SHOW_POPUP","HIDE_POPUP","TOGGLE_VERTICAL_POSITION","contains","remove","$a373d99da8d74fbb$var$toggleVerticalPosition","TOGGLE_HORIZONTAL_POSITION","$a373d99da8d74fbb$var$toggleHorizontalPosition","SET_MAX_HEIGHT","maxHeight","CHECK_INSTALLATION"],"version":3,"file":"content-script.js.map"}
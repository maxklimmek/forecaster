(()=>{let e;var t;(t=e||(e={})).TOGGLE_POPUP="TOGGLE_POPUP",t.SHOW_POPUP="SHOW_POPUP",t.HIDE_POPUP="HIDE_POPUP",t.TOGGLE_VERTICAL_POSITION="TOGGLE_VERTICAL_POSITION",t.TOGGLE_HORIZONTAL_POSITION="TOGGLE_HORIZONTAL_POSITION",t.SET_MAX_HEIGHT="SET_MAX_HEIGHT",t.CHECK_INSTALLATION="CHECK_INSTALLATION";const n="__sales_discount_calculator__";function s(e,t){const s=chrome.runtime.getManifest().version;return{source:n,action:e,payload:t,version:s}}function r(e){const t=chrome.runtime.getManifest().version;return e?.source===n&&e?.version===t}const o=e=>{const t=e.split(":")[0];return["http","https","file","ftp","urn"].includes(t)};chrome.action.onClicked.addListener((t=>{if(!o(t.url)){const e=chrome.runtime.getURL("index.html");return chrome.tabs.create({url:`${e}?standalone=true`,active:!0}),!0}const n=s(e.TOGGLE_POPUP);chrome.tabs.sendMessage(t.id,n)})),chrome.runtime.onMessage.addListener(((e,t,n)=>{r(e)?chrome.tabs.sendMessage(t.tab.id,e):console.log("Validation failed!!")}));chrome.runtime.onInstalled.addListener((async()=>{const t=await chrome.tabs.query({});await Promise.all(t.map((t=>new Promise((n=>{if(!o(t.url))return n();const r=s(e.CHECK_INSTALLATION);chrome.tabs.sendMessage(t.id,r,(e=>{console.log({response:e},chrome.runtime.lastError),(chrome.runtime.lastError||"installed"!==e)&&(console.log("Content script isn't installed, doing it manually"),chrome.scripting.executeScript({target:{tabId:t.id},files:["content-script.js"],injectImmediately:!0}),chrome.scripting.insertCSS({target:{tabId:t.id},files:["content-style.css"]})),n()}))})))))}))})();
//# sourceMappingURL=background-script.js.map
